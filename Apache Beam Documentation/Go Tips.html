<p>See the <a class="external-link" href="https://github.com/apache/beam/blob/master/sdks/go/README.md" rel="nofollow">Go SDK Developer README at the sdks/go root</a> for getting started with working on the Go SDK. In particular, the SDK is currently opinionated about where the beam repo needs to be copied in order for Go to use your SDK changes rather than it's own cached copy.</p><h2 id="GoTips-ContributionRecommendations">Contribution Recommendations</h2><p>If you're looking to contribute to the Apache Beam and wish to do so with the Go SDK, you're welcome to! This section links to pages with recommendations of what and how to contribute.</p><ul><li><a href="/confluence/display/BEAM/Supporting+Streaming+in+the+Go+SDK">Supporting Streaming in the Go SDK</a> - Help make the Go SDK feature complete, and more efficient!</li><li><a class="external-link" href="https://issues.apache.org/jira/browse/BEAM-11077" rel="nofollow">BEAM-11077</a> - Help make the Python Portable runner easier to use with the Go SDK!</li><li><a class="external-link" href="https://issues.apache.org/jira/browse/BEAM-11076" rel="nofollow">BEAM-11076</a> - Help make the Go Direct Runner useful, and portable!</li><li><a class="external-link" href="https://beam.apache.org/roadmap/go-sdk/" rel="nofollow">Current Go SDK Roadmap</a> - What's being worked on at present.</li><li>Add the Go SDK to the <a class="external-link" href="https://beam.apache.org/documentation/programming-guide" rel="nofollow">Beam Programming Guide</a>!</li><li>Make the <a class="external-link" href="https://pkg.go.dev/github.com/apache/beam/sdks/go/pkg/beam" rel="nofollow">beam package GoDoc</a> more useful! </li><li><a class="external-link" href="https://issues.apache.org/jira/issues/?jql=project%20%3D%20BEAM%20AND%20status%20in%20(Open%2C%20%22In%20Progress%22%2C%20Idea%2C%20%22Under%20Discussion%22%2C%20%22In%20Implementation%22%2C%20%22Triage%20Needed%22)%20AND%20component%20%3D%20sdk-go%20ORDER%20BY%20updated%20DESC" rel="nofollow">File and add additional JIRAs!</a></li></ul><h2 id="GoTips-DevelopmentRecommendations">Development Recommendations</h2><ul><li>Follow the instructions in<span style="color: rgb(23,43,77);"><span> </span></span><a class="external-link" href="https://github.com/apache/beam/blob/master/sdks/go/README.md" rel="nofollow" style="text-decoration: none;">Go SDK Developer README at the sdks/go root</a></li><li><span style="color: rgb(23,43,77);">Use the Python Portable Runner for end to end testing and validation of pipelines</span><ul><li><span style="color: rgb(23,43,77);">Follow the instructions in <a href="/confluence/display/BEAM/Python+Tips">Python Tips</a> to have a working python SDK environment.</span></li><li><span style="color: rgb(23,43,77);">Ensure you're in the python virtual env.</span></li><li>From the <a class="external-link" href="https://github.com/apache/beam/tree/master/sdks/python" rel="nofollow">sdks/python directory</a>, start a stand alone Python Portable Runner Job Service  <ul><li><code>python -m apache_beam.runners.portability.local_job_service_main --port=8099</code></li></ul></li><li>Submit jobs with the flags :<ul><li><pre> --runner=universal --endpoint=localhost:8099 --environment_type=LOOPBACK</pre></li></ul></li><li>If this seems like too many steps, consider making the Python Portable runner more easily accessible to the Go SDK – <a class="external-link" href="https://issues.apache.org/jira/browse/BEAM-11077" rel="nofollow">BEAM-11077</a></li></ul></li><li>Consider alternatively using a local Spark or Flink instance to test pipelines. They can be spun up via beam repo gradle commands:<ul><li><span style="letter-spacing: 0.0px;">Flink <code>./gradlew :runners:flink:1.16:job-server:runShadow</code> </span></li><li><span style="letter-spacing: 0.0px;">Spark <code>./gradlew :runners:spark:3:job-server:runShadow</code> </span></li></ul></li><li>Do not use the &quot;Go Direct&quot; runner. It's not much more than a toy suitable for limited basic batch testing. It's a separate task to make it more generally useful – <a class="external-link" href="https://issues.apache.org/jira/browse/BEAM-11076" rel="nofollow" style="letter-spacing: 0.0px;">BEAM-11076</a></li></ul><h2 id="GoTips-Testing">Testing</h2><h3 id="GoTips-ValidatesRunnerTests">ValidatesRunner Tests</h3><p>ValidatesRunner tests are basic integration tests of SDK functionality, such as primitive transforms, that can be run on assorted runners. These tests are present in <code><span style="color: rgb(0,51,102);">beam/sdks/go/test/integration</span></code><span style="color: rgb(0,51,102);">.</span></p><h4 id="GoTips-AddingTests"><span style="color: rgb(0,0,0);">Adding Tests</span></h4><p><span style="color: rgb(0,0,0);">The documentation for package <code>integration</code> contains information on adding new tests. In general, these are the main differences from regular unit tests:</span></p><ol><li>All integration tests should be in a subpackage, not in the root <code>integration</code> package.</li><li>Integration tests should be executing pipelines with <code>ptest.Run()</code>. Tests that do not execute pipelines likely do not belong as integration tests.<ol><li>If this is a new package, it's required that <code>TestMain(m *testing.M)</code> is defined and calls <code>ptest.Main(m)</code>.</li></ol></li><li><p class="auto-cursor-target">The integration package defines a way to enable test filtering for your integration test. Call <code><span class="pl-s1">integration</span>.<span class="pl-en"><span class="pl-token">CheckFilters</span></span>(<span class="pl-s1">t</span>) </code>at the start of the test. integration.go contains the various runner specific filters, to filter out tests per runner, if they don't support the given feature under test. All integration tests should have test filtering enabled.</p><ol><li>The test filter will fail the test in the event <code>TestMain</code> doesn't call<code> ptest.Main</code>.</li></ol></li></ol><h4 id="GoTips-RunningTests">Running Tests</h4><ol><li><u>Manually</u>: Tests can be run manually with the usual go test command by including any necessary flags. This approach is useful for running specific tests, but it requires any necessary services, such as job servers and cross-language expansion services, to be available with endpoints to use. For example:<ul><li><pre>go test -v ./sdks/go/test/integration/... --runner=portable --endpoint=localhost:8099</pre></li></ul></li><li><u>Script</u>: The  script <code style="letter-spacing: 0.0px;">beam/sdks/go/test/run_validatesrunner_tests.sh</code><span style="letter-spacing: 0.0px;"> can be run to provide some automation, and is more convenient for running a runner with more complex configuration, such as Dataflow.</span></li><li><span style="letter-spacing: 0.0px;"><u>Gradle</u>: There are gradle tasks to build required services and run the script in <code>beam/sdks/go/test/build.gradle</code>. This approach is recommended for a convenient way of running the full integration test suite on a single runner. For example:</span><ul><li><pre>./gradlew :clean :sdks:go:test:ulrValidatesRunner</pre></li></ul></li></ol><div class="confluence-information-macro confluence-information-macro-note conf-macro output-block" data-hasbody="true" data-macro-name="note"><p class="title conf-macro-render">Note on Cross-Language</p><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>Container issues have been known to occur when running cross-language pipelines with outdated vendored code in other languages. If you encounter container issues while running cross-language tests, perform the following steps to rebuild the docker container from up-to-date code:</p><ol><li>Delete your local containers for the language in question, like so:<ul><li><pre>docker image rm &lt;image_id&gt;</pre></li></ul></li><li><pre>./gradlew :clean</pre></li><li>Rerun the gradle command to rebuild the containers and run the integration tests.</li></ol></div></div><h2 id="GoTips-Cross-LanguageQuickstart">Cross-Language Quickstart</h2><p><a class="external-link" href="https://docs.google.com/presentation/d/1Kdl-srcL6jvqOa06rRbWzM2ASKIQuUiuycCyHkEgWGw/edit?usp=sharing" rel="nofollow">Go Cross-Language IO Quickstart Slides</a></p><p>The above slides are from a talk given to beginner developers on the Beam Go SDK, and may be a good starting point for future Beam developers.</p><p><br/></p>